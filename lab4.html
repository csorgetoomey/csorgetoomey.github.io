<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Lab 4</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<!-- the leaflet CSS and JS library-->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
		   	integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
		   	crossorigin=""/>
		<!-- Make sure you put this AFTER Leaflet's CSS -->
		<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
		   	integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
		   	crossorigin=""></script>
		<!-- Add JQuery to get local GeoJson file -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<!-- the mapbox libraries -->
		<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>
		<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />

		<!-- openweathermap stuff -->
		<link rel="stylesheet" type="text/css" href="assets/css/leaflet-openweathermap.css" />
		<script type="text/javascript" src="assets/js/leaflet-openweathermap.js"></script>

		<!-- leaflet reset zoom functionality -->
		<link rel="stylesheet" href="assets/css/L.Control.ZoomMin.css" media="screen">
		<script src="assets/js/L.Control.ZoomMin.js"></script>

	</head>
	<body class="is-preload">
		<!-- Wrapper -->
		<div id="wrapper">
			<!-- Header -->
			<header id="header">
				<h1>Lab 4</h1>
			</header>
				<!-- Main -->
				<div id="main">
					<!-- Content -->
					<section id="content" class="main">

						<h2>Leaflet Map + Weather Data</h2>
						<p>Click top right icon on map for layers.</p>
						<div id="map" style='width: 100%; height: 600px;'></div>
						<script> 
							//basemap from https://leaflet-extras.github.io/leaflet-providers/preview/
							var Stamen_TonerLite = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.{ext}', {
								attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
								subdomains: 'abcd',
								minZoom: 0,
								maxZoom: 20,
								ext: 'png'
							});

							//code from openweathermaps
							var clouds = L.OWM.clouds({opacity: 0.7, appId: 'd20e36bf39c19062a8275929417ea165'});
							var temp = L.OWM.temperature({opacity: 0.3, appId: 'd20e36bf39c19062a8275929417ea165'});
							var precipitation = L.OWM.precipitation({opacity: 0.5, appId: 'd20e36bf39c19062a8275929417ea165'});
							var wind = L.OWM.wind({opacity: 0.3, appId: 'd20e36bf39c19062a8275929417ea165'});
							var pressure = L.OWM.pressure({opacity: 0.4, appId: 'd20e36bf39c19062a8275929417ea165'});

							var map = new L.Map("map", {
								center: new L.LatLng(47.221769, -122.457158),
								zoom: 3,
								minZoom:3,
								maxZoom:16,
								zoomControl: false
							});
							map.addLayer(Stamen_TonerLite);
							//adds reset zoom button
							map.addControl(new L.Control.ZoomMin())

							var baseMaps = { "Weather Layers": Stamen_TonerLite };
							var overlayMaps = { "Clouds": clouds, "Precipitation": precipitation, "Temperature": temp, "Wind": wind, "Pressure": pressure };
							var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);



						</script>

						<br><br>

						<!--most of this is from the example on the class GitHub -->
						<h2>Mapbox Map + Earthquake Data</h2>
						<!-- the div for the map -->
						<div id='boxmap' style='width: 100%; height: 600px;'></div>
						<!-- the script for the map -->
						<script>
							//mapbox token
							mapboxgl.accessToken = 'pk.eyJ1IjoiY3NvcmdlIiwiYSI6ImNqb3A2cGMwMzAxbTkzcW9meDIzMDE0ZHMifQ.R5gWO0aBEldQdqU0Nlir-Q';
							
							//The map variable
							var map = new mapboxgl.Map({
							    container: 'boxmap',
							    style: 'mapbox://styles/csorge/cjop8lomm4syh2ro1oogrl0fo',
							    center: [-122, 45],
							    zoom: 2
							});
							//on map load, do some stuff
							map.on('load', function(){
								//add a source layer for earthquakes
								map.addSource('earthquakes', {
							        "type": "geojson",
							        "data": "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson"
							    });
							    //add the earthquakes to the map
							    map.addLayer({
							    	"id":"equakes",
							    	"type":"circle",
							    	"source":"earthquakes"
							    });
								//Thanks to: https://www.mapbox.com/mapbox-gl-js/example/popup-on-click/ 
								map.on('click', 'equakes', function (e) {
							        var coordinates = e.features[0].geometry.coordinates.slice();
							        var description = "<p><br>Magnitude: " + e.features[0].properties.mag + "<br>Location: " + e.features[0].properties.place + "<br>URL: <a href='" +  e.features[0].properties.url + "'target=newtab>click here</a></p>"
							        // Ensure that if the map is zoomed out such that multiple
							        // copies of the feature are visible, the popup appears
							        // over the copy being pointed to.
							        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
							            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
							        }
							        //make the popup
							        new mapboxgl.Popup()
							            .setLngLat(coordinates)
							            .setHTML(description)
							            .addTo(map);
							    });


							});
						</script>
						<br>

					</section>

				</div>

				<!-- Footer -->
			<footer id="footer">
				<p class="copyright">&copy; csorgetoomey Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
			</footer>

		</div>

		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>

	</body>
</html>